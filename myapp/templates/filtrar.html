{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>üé¨ Filtros avanzados de pel√≠culas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'styles/index.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-light">

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="/">üé• Cinedot</a>
            <div>
                <a href="/" class="btn btn-outline-light btn-sm">Inicio</a>
            </div>
        </div>
    </nav>

    <!-- Contenido principal -->
    <div class="container mt-4">
        <h2 class="text-center mb-4">üé¨ Filtros avanzados de pel√≠culas</h2>

        <!-- Formulario de filtros -->
        <form method="GET" class="row g-3 mb-4">
            <div class="col-md-3">
                <label for="genero" class="form-label">G√©nero</label>
                <select name="genero" id="genero" class="form-select">
                    <option value="">Todos</option>
                    {% for codigo, nombre in GENERO_CHOICES %}
                        <option value="{{ codigo }}" {% if request.GET.genero == codigo %}selected{% endif %}>{{ nombre }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-md-3">
                <label for="clasificacion" class="form-label">Clasificaci√≥n</label>
                <select name="clasificacion" id="clasificacion" class="form-select">
                    <option value="">Todas</option>
                    <option value="APT" {% if request.GET.clasificacion == "APT" %}selected{% endif %}>APT</option>
                    <option value="13+" {% if request.GET.clasificacion == "13+" %}selected{% endif %}>13+</option>
                    <option value="18+" {% if request.GET.clasificacion == "18+" %}selected{% endif %}>18+</option>
                </select>
            </div>

            <div class="col-md-3">
                <label for="idioma" class="form-label">Idioma</label>
                <select name="idioma" id="idioma" class="form-select">
                    <option value="">Todos</option>
                    <option value="Espa√±ol" {% if request.GET.idioma == "Espa√±ol" %}selected{% endif %}>Espa√±ol</option>
                    <option value="Ingl√©s" {% if request.GET.idioma == "Ingl√©s" %}selected{% endif %}>Ingl√©s</option>
                    <option value="Subtitulada" {% if request.GET.idioma == "Subtitulada" %}selected{% endif %}>Subtitulada</option>
                </select>
            </div>

            <div class="col-md-3">
                <label for="horario" class="form-label">Horario</label>
                <select name="horario" id="horario" class="form-select">
                    <option value="">Todos</option>
                    {% for hora in HORARIOS_DISPONIBLES %}
                        <option value="{{ hora }}" {% if request.GET.horario == hora %}selected{% endif %}>{{ hora }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-12 text-center">
                <button type="submit" class="btn btn-primary mt-3">üîç Filtrar</button>
                <a href="{% url 'filtrar_peliculas' %}" class="btn btn-secondary mt-3">üîÑ Limpiar</a>
            </div>
        </form>

       <!-- Resultados -->
<div class="row">
    {% if peliculas %}
        {% for pelicula in peliculas %}
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm">
                    
                    <!-- Imagen de la pel√≠cula -->
                    <div class="poster-container">
                        <img src="{{ pelicula.imagen_url }}" alt="{{ pelicula.nombre }}" class="movie-poster img-fluid rounded-top">
                    </div>

                    <!-- Informaci√≥n de la pel√≠cula -->
                    <div class="card-body">
                        <h5 class="card-title">{{ pelicula.nombre }}</h5>
                        <p class="card-text mb-1"><strong>G√©nero:</strong> {{ pelicula.get_generos_list|join:", " }}</p>
                        <p class="card-text mb-1"><strong>A√±o:</strong> {{ pelicula.anio }}</p>
                        <p class="card-text mb-1"><strong>Director:</strong> {{ pelicula.director }}</p>
                        <p class="card-text mb-1"><strong>Horario y Sala:</strong>
                            {% for h, s in pelicula.horario_sala_pares %}
                                {{ h }} - {{ s }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </p>
                        <p class="card-text mb-1"><strong>Clasificaci√≥n:</strong> {{ pelicula.get_clasificacion_display }}</p>
                        <p class="card-text mb-1"><strong>Idioma:</strong> {{ pelicula.get_idioma_display }}</p>
                    </div>

                </div>
            </div>
        {% endfor %}
    {% else %}
        <p class="text-center text-muted">No se encontraron pel√≠culas con esos filtros.</p>
    {% endif %}
</div>



    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3 mt-4">
        &copy; 2025 Cinedot | Proyecto Django TL21001
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
